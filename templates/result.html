<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <title>Deepfake Detection Result</title>
  <style>
    body {
      background-color: #f8f9fa;
      margin-bottom: 40px;
    }
    .container {
      margin-top: 20px;
      margin-bottom: 20px;
    }
    .card {
      border: 0;
      border-radius: 15px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .card-header {
      background-color: #007bff;
      border-radius: 15px 15px 0 0;
      padding: 15px;
    }
    .card-title {
      color: #ffffff;
      font-size: 1.5rem;
    }
    .card-body {
      padding: 15px;
    }
    .btn-primary {
      background-color: #007bff;
      border: 0;
    }
    footer {
      background-color: #343a40;
      color: #ffffff;
      padding: 5px 0;
      width: 100%;
      position: fixed;
      bottom: 0;
    }
    .video-frame {
      max-width: 100%;
      height: auto;
    }
    .info-card {
      margin-top: 20px;
    }
    .info-card,
    .detection-label {
      margin-left: 100px;
    }
    .progress-container {
      margin-left: 145px;
      margin-bottom: 20px;
    }
    .blockchain-data {
      background-color: #e9ecef;
      padding: 15px;
      border-radius: 10px;
      margin-top: 20px;
    }
    .ai-model-data {
      background-color: #e9ecef;
      padding: 15px;
      border-radius: 10px;
      margin-top: 20px;
    }
    /* Additional style for audio chart if needed */
  </style>
</head>
<body>

  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="#">DeFendReality</a>
    </div>
  </nav>

  <div class="container">
    <div class="card">
      <div class="card-header">
        <h1 class="card-title">Deepfake Detection Result</h1>
      </div>
      <div class="card-body">
        <div class="row">
          <!-- Video frame -->
          <div class="col-md-8">
            <video controls class="video-frame">
              <source src="{{ video_url }}" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>

          <!-- Video & Audio Information -->
          <div class="col-md-4">
            <div class="info-card">
              <h5>Video Information:</h5>
              <br>
              <p><strong style="color: #034f84;">Name:</strong> {{ video_info['name'] }}</p>
              <p><strong style="color: #034f84;">Size:</strong> {{ video_info['size'] }}</p>
              <p><strong style="color: #034f84;">User:</strong> {{ video_info['user'] }}</p>
              <p><strong style="color: #034f84;">Date:</strong> {{ video_info['source'] }}</p>
              <p><strong style="color: #034f84;">Video Fake Accuracy:</strong> {{ video_info['video_accuracy'] }}%</p>
              <p><strong style="color: #034f84;">Audio Fake Accuracy:</strong> {{ video_info['audio_accuracy'] }}%</p>
            </div>

            <br>
            <br>

            <!-- Deepfake Detection Rate Label for Video -->
            <div class="detection-label">
              <h5 class="bold-text">Video Deepfake Detection Rate:</h5>
            </div>
            <br>
            <!-- Circular Progress Bar for Video -->
            <div class="progress-container">
              <svg class="circle-progress" width="150" height="150" xmlns="http://www.w3.org/2000/svg">
                <!-- Circle Frame -->
                <circle class="progress-circle" cx="75" cy="75" r="70" fill="none" stroke="#ccc" stroke-width="8"></circle>
                <!-- Progress Bar -->
                <circle class="progress-bar-video" cx="75" cy="75" r="70" fill="none" stroke="#4CAF50" stroke-width="8" stroke-dasharray="0 440"></circle>
                <!-- Percentage Label -->
                <text class="progress-label-video" x="50%" y="50%" text-anchor="middle" dy=".3em" font-size="24" fill="#333"></text>
              </svg>
            </div>

            <!-- Deepfake Detection Rate Label for Audio -->
            <div class="detection-label">
              <h5 class="bold-text">Audio Deepfake Detection Rate:</h5>
            </div>
            <br>
            <!-- Circular Progress Bar for Audio -->
            <div class="progress-container">
              <svg class="circle-progress" width="150" height="150" xmlns="http://www.w3.org/2000/svg">
                <!-- Circle Frame -->
                <circle class="progress-circle" cx="75" cy="75" r="70" fill="none" stroke="#ccc" stroke-width="8"></circle>
                <!-- Progress Bar -->
                <circle class="progress-bar-audio" cx="75" cy="75" r="70" fill="none" stroke="#FF5722" stroke-width="8" stroke-dasharray="0 440"></circle>
                <!-- Percentage Label -->
                <text class="progress-label-audio" x="50%" y="50%" text-anchor="middle" dy=".3em" font-size="24" fill="#333"></text>
              </svg>
            </div>

            <div class="blockchain-data">
              <h5>Blockchain Data:</h5>
              <p><strong>Block Index:</strong> {{ blockchain.chain[-1]['index'] }}</p>
              <p><strong>Timestamp:</strong> {{ blockchain.chain[-1]['timestamp'] }}</p>
              <p><strong>File Hash:</strong> {{ blockchain.chain[-1]['transactions'][0]['file_hash'] }}</p>
              <p><strong>Uploader:</strong> {{ blockchain.chain[-1]['transactions'][0]['uploader'] }}</p>
              <p><strong>Location:</strong> {{ blockchain.chain[-1]['transactions'][0]['location'] }}</p>
            </div>

            <!-- AI Model Transparency -->
            <div class="ai-model-data">
              <h5>AI Model Transparency:</h5>
              {% if blockchain.chain[-1]['transactions']|length > 1 and blockchain.chain[-1]['transactions'][1].get('model_name') %}
                <p><strong>Model Name:</strong> {{ blockchain.chain[-1]['transactions'][1]['model_name'] }}</p>
                <p><strong>Dataset:</strong> {{ blockchain.chain[-1]['transactions'][1]['dataset'] }}</p>
                <p><strong>Version:</strong> {{ blockchain.chain[-1]['transactions'][1]['version'] }}</p>
              {% elif blockchain.current_transactions|length > 0 and blockchain.current_transactions[0].get('model_name') %}
                <p><strong>Model Name:</strong> {{ blockchain.current_transactions[0]['model_name'] }}</p>
                <p><strong>Dataset:</strong> {{ blockchain.current_transactions[0]['dataset'] }}</p>
                <p><strong>Version:</strong> {{ blockchain.current_transactions[0]['version'] }}</p>
              {% else %}
                <p>AI model metadata not available.</p>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <div class="container text-center">
      <p>&copy; Deepfake Detection</p>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Update progress bar for video accuracy
    var videoProgressValue = parseFloat("{{ video_info['video_accuracy'] }}");
    document.querySelector(".progress-bar-video").style.strokeDasharray = videoProgressValue + " 100";
    document.querySelector(".progress-label-video").textContent = Math.round(videoProgressValue) + "%";

    // Update progress bar for audio accuracy
    var audioProgressValue = parseFloat("{{ video_info['audio_accuracy'] }}");
    document.querySelector(".progress-bar-audio").style.strokeDasharray = audioProgressValue + " 100";
    document.querySelector(".progress-label-audio").textContent = Math.round(audioProgressValue) + "%";
  </script>
</body>
</html>
